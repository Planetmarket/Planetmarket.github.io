<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Interactive Agriculture Flow</title>
<style>
/* Reset & Base */
* { box-sizing: border-box; margin:0; padding:0; }
body {
    font-family: sans-serif;
    background: linear-gradient(160deg, #e6f4ea, #c6e0c3);
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: flex-start;
    min-height: 100vh;
    color: #000;
}

/* Header */
header {
    text-align: center;
    margin: 20px 0;
}
header h1 { font-size: clamp(1.8rem,4vw,2.8rem); }
header p { font-size: clamp(1rem,2vw,1.3rem); font-style: italic; margin-top:5px; }

/* Diagram Container (Centered) */
.diagram-wrapper {
    width: 100%;
    display: flex;
    justify-content: center;
}
.diagram-container {
    display: grid;
    grid-template-columns: repeat(5,1fr);
    grid-template-rows: repeat(4,1fr);
    width: 95%;
    max-width: 1200px;
    aspect-ratio: 5 / 4;
    gap: 10px;
    position: relative;
}

/* Diagram Cells */
.diagram-cell {
    display: flex;
    justify-content: center;
    align-items: center;
    text-align: center;
    position: relative;
}

/* Buttons: Equal Width */
button {
    font-size: clamp(0.6rem,1.8vw,1rem);
    min-height: clamp(40px,6vw,60px);
    width: 90%;       /* All buttons same width */
    max-width: 100%;
    padding: clamp(8px,2vw,14px);
    border: none;
    border-radius: 12px;
    cursor: pointer;
    font-weight: 600;
    color: #fff;
    transition: transform 0.15s ease, box-shadow 0.15s ease;
}
button:hover { transform: translateY(-3px) scale(1.03); box-shadow:0 6px 12px rgba(0,0,0,0.25);}
button:active { transform: translateY(0) scale(0.97); box-shadow:0 3px 6px rgba(0,0,0,0.2); }

/* Button Types */
.btn-goal { background: linear-gradient(145deg,#FFB900,#FFC84D); color:#000; }
.btn-problem { background: linear-gradient(145deg,#ff4500,#ff6b42); }
.btn-solution { background: linear-gradient(145deg,#107C10,#3aa64a); }
.btn-platform { background: linear-gradient(145deg,#006ee6,#3b9fff); }

/* Ripple Effect */
.ripple { position:absolute; border-radius:50%; background: rgba(255,255,255,0.5); transform:scale(0); animation:ripple 0.6s linear; pointer-events:none; z-index:20; }
@keyframes ripple { to { transform:scale(4); opacity:0; } }

/* SVG Lines */
#diagramConnections {
    position:absolute;
    inset:0;
    width:100%;
    height:100%;
    pointer-events:none;
    z-index:0;
}
.line { stroke:#000; stroke-width:1.5; fill:none; stroke-linecap:round; stroke-dasharray:5 5; animation:flow 2s linear infinite; }
@keyframes flow { to { stroke-dashoffset:-20; } }
.diagram-container:hover .line { stroke:#00f; filter:drop-shadow(0 0 3px rgba(0,0,0,0.5)); }

/* Details Panel */
.details-panel {
    background: rgba(255,255,255,0.9);
    padding: 20px;
    border-radius: 12px;
    box-shadow: 0 4px 12px rgba(0,0,0,0.1);
    width: 95%;
    max-width: 1200px;
    min-height: 120px;
    font-size: 1rem;
    color: #333;
    margin: 20px 0;
    text-align: center;
    line-height:1.5;
    font-family: 'Comic Neue', cursive;
}
</style>
</head>
<body>

<header>
    <h1>PLANET MARKET</h1>
    <p>Explore goals, problems, solutions, and technologies interactively</p>
</header>

<main>
<div class="diagram-wrapper">
<div class="diagram-container" id="diagramContainer">
    <svg id="diagramConnections" viewBox="0 0 500 400" preserveAspectRatio="none"></svg>

    <!-- Row 1 -->
    <div class="diagram-cell"></div>
    <div class="diagram-cell"></div>
    <div class="diagram-cell"><button class="btn-goal" data-row="0" data-col="2" data-description="Ensure stable agriculture income through sustainable practices.">Agriculture Income</button></div>
    <div class="diagram-cell"></div>
    <div class="diagram-cell"></div>

    <!-- Row 2 -->
    <div class="diagram-cell"><button class="btn-problem" data-row="1" data-col="0" data-description="Weather unpredictability affects crops and yields.">Weather</button></div>
    <div class="diagram-cell"><button class="btn-problem" data-row="1" data-col="1" data-description="Pest infestations reduce productivity.">Pest</button></div>
    <div class="diagram-cell"><button class="btn-problem" data-row="1" data-col="2" data-description="Small farms have limited resources and capacity.">Small Farms</button></div>
    <div class="diagram-cell"><button class="btn-problem" data-row="1" data-col="3" data-description="Market price volatility affects farmers' income.">Price</button></div>
    <div class="diagram-cell"><button class="btn-problem" data-row="1" data-col="4" data-description="Intermediaries often reduce farmers' profit margins.">Intermediaries</button></div>

    <!-- Row 3 -->
    <div class="diagram-cell"><button class="btn-solution" data-row="2" data-col="0" data-description="Adaptable strategies to uncontrollable events.">Uncontrollable</button></div>
    <div class="diagram-cell"><button class="btn-solution" data-row="2" data-col="1" data-description="Proper pesticide management to reduce losses.">Pesticides</button></div>
    <div class="diagram-cell"><button class="btn-solution" data-row="2" data-col="2" data-description="Improve processing to increase finished products.">Finished Products</button></div>
    <div class="diagram-cell"><button class="btn-solution" data-row="2" data-col="3" data-description="Use data to anticipate demand accurately.">Demand Data</button></div>
    <div class="diagram-cell"><button class="btn-solution" data-row="2" data-col="4" data-description="Implement practices to avoid losses.">Avoidable</button></div>

    <!-- Row 4 -->
    <div class="diagram-cell"></div>
    <div class="diagram-cell"></div>
    <div class="diagram-cell"></div>
    <div class="diagram-cell"><button class="btn-platform" data-row="3" data-col="3" data-description="Planet Market technologies facilitate applying solutions.">Planet Market</button></div>
    <div class="diagram-cell"></div>
</div>
</div>

<div class="details-panel" id="detailsPanel">Click a button to see insights here.</div>
</main>

<script>
// Get center coordinates of a button inside container
function getButtonCenter(button) {
    const container = document.getElementById('diagramContainer');
    const rect = button.getBoundingClientRect();
    const containerRect = container.getBoundingClientRect();
    return { 
        x: ((rect.left + rect.width/2) - containerRect.left) / containerRect.width * 500,
        y: ((rect.top + rect.height/2) - containerRect.top) / containerRect.height * 400
    };
}

// Draw SVG connections
function drawConnections() {
    const svg = document.getElementById('diagramConnections');
    svg.innerHTML = '';
    const buttons = document.querySelectorAll('button');
    const buttonMap = {};
    buttons.forEach(btn => buttonMap[`${btn.dataset.row}-${btn.dataset.col}`] = getButtonCenter(btn));

    const connections = [
        {from:'1-0',to:'0-2'},{from:'1-1',to:'0-2'},{from:'1-2',to:'0-2'},{from:'1-3',to:'0-2'},{from:'1-4',to:'0-2'},
        {from:'1-0',to:'2-0'},{from:'1-1',to:'2-1'},{from:'1-2',to:'2-2'},{from:'1-3',to:'2-3'},{from:'1-4',to:'2-4'},
        {from:'2-2',to:'3-3'},{from:'2-3',to:'3-3'},{from:'2-4',to:'3-3'}
    ];

    connections.forEach(conn => {
        if(buttonMap[conn.from] && buttonMap[conn.to]){
            const line = document.createElementNS('http://www.w3.org/2000/svg','line');
            line.classList.add('line');
            line.setAttribute('x1', buttonMap[conn.from].x);
            line.setAttribute('y1', buttonMap[conn.from].y);
            line.setAttribute('x2', buttonMap[conn.to].x);
            line.setAttribute('y2', buttonMap[conn.to].y);
            svg.appendChild(line);
        }
    });
}

// Ripple & details panel
const detailsPanel = document.getElementById('detailsPanel');
document.querySelectorAll('button').forEach(btn => {
    btn.addEventListener('click', e => {
        const circle = document.createElement('span');
        circle.classList.add('ripple');
        const rect = btn.getBoundingClientRect();
        const size = Math.max(rect.width, rect.height);
        circle.style.width = circle.style.height = size + 'px';
        circle.style.left = (e.clientX - rect.left - size/2)+'px';
        circle.style.top = (e.clientY - rect.top - size/2)+'px';
        btn.appendChild(circle);
        setTimeout(()=>circle.remove(),600);

        detailsPanel.textContent = btn.dataset.description;
    });
});

// Initial draw
window.addEventListener('load', drawConnections);
const resizeObserver = new ResizeObserver(drawConnections);
resizeObserver.observe(document.getElementById('diagramContainer'));
</script>
</body>
</html>
