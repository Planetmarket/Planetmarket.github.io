<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Interactive Agriculture Flow</title>
<style>
* { box-sizing: border-box; margin:0; padding:0; }
body {
    font-family: sans-serif;
    min-height: 100vh;
    background: linear-gradient(160deg, #e6f4ea, #c6e0c3);
    display: flex;
    align-items: center;
    justify-content: center;
    padding: 20px;
}

.grid-container {
    display: grid;
    grid-template-columns: repeat(5, 1fr);
    grid-template-rows: repeat(4, 1fr);
    gap:0;
    position: relative;
    width: 300px;
    height: 240px;
}

.grid-cell { display:flex; justify-content:center; align-items:center; position:relative; text-align:center; padding:3px; }

button {
    font-size: 0.5rem;
    font-weight:600;
    border:none;
    border-radius:6px;
    cursor:pointer;
    transition: transform 0.15s ease, box-shadow 0.15s ease, background-color 0.2s ease;
    box-shadow:0 2px 6px rgba(0,0,0,0.2);
    display:flex;
    align-items:center;
    justify-content:center;
    width:90%;
    max-width:90%;
    min-height: 32px;
    padding:6px 8px;
    position:relative;
    overflow:hidden;
    line-height:1.2;
    text-align:center;
    color:#fff;
}

button:hover { transform: translateY(-3px) scale(1.03); box-shadow:0 6px 12px rgba(0,0,0,0.25); }
button:active { transform: translateY(0) scale(0.97); box-shadow:0 3px 6px rgba(0,0,0,0.2); }

.ripple { position:absolute; border-radius:50%; background: rgba(255,255,255,0.5); transform:scale(0); animation:ripple 0.6s linear; pointer-events:none; z-index:20; }
@keyframes ripple { to { transform:scale(4); opacity:0; } }

/* Button colors */
.row1-btn { background: linear-gradient(145deg,#FFB900,#FFC84D); color:#000; }
.row3-btn { background: linear-gradient(145deg,#ff4500,#ff6b42); color:#fff; }
.row5-btn { background: linear-gradient(145deg,#107C10,#3aa64a); color:#fff; }
.row7-btn { background: linear-gradient(145deg,#006ee6,#3b9fff); color:#fff; }

svg { position:absolute; inset:0; width:100%; height:100%; pointer-events:none; z-index:0; }
.line { stroke:#000; stroke-width:1; fill:none; stroke-linecap:round; stroke-dasharray:5 5; animation:flow 2s linear infinite; transition: stroke 0.3s ease; }
@keyframes flow { to { stroke-dashoffset:-20; } }
.grid-container:hover .line { stroke:#00f; filter:drop-shadow(0 0 3px rgba(0,0,0,0.5)); }

@media (max-width:768px) { button { font-size: 0.5rem; min-height: 32px; } .line { stroke-width:1; } }
@media (max-width:480px) { button{font-size:0.5rem; min-height:32px;} .line{stroke-width:1;} }
@media (max-width:360px) { button{font-size:0.45rem; min-height:30px;} }
</style>
</head>
<body>

<div class="grid-container">
    <svg id="connectionSvg"></svg>

    <!-- Row 1 -->
    <div class="grid-cell"></div>
    <div class="grid-cell"></div>
    <div class="grid-cell"><button class="row1-btn" data-row="0" data-col="2">Agriculture Income</button></div>
    <div class="grid-cell"></div>
    <div class="grid-cell"></div>

    <!-- Row 2 -->
    <div class="grid-cell"><button class="row3-btn" data-row="1" data-col="0">Weather</button></div>
    <div class="grid-cell"><button class="row3-btn" data-row="1" data-col="1">Pest</button></div>
    <div class="grid-cell"><button class="row3-btn" data-row="1" data-col="2">Small Farms</button></div>
    <div class="grid-cell"><button class="row3-btn" data-row="1" data-col="3">Price</button></div>
    <div class="grid-cell"><button class="row3-btn" data-row="1" data-col="4">Intermediaries</button></div>

    <!-- Row 3 -->
    <div class="grid-cell"><button class="row5-btn" data-row="2" data-col="0">Uncontrollable</button></div>
    <div class="grid-cell"><button class="row5-btn" data-row="2" data-col="1">Pesticides</button></div>
    <div class="grid-cell"><button class="row5-btn" data-row="2" data-col="2">Finished Products</button></div>
    <div class="grid-cell"><button class="row5-btn" data-row="2" data-col="3">Demand Data</button></div>
    <div class="grid-cell"><button class="row5-btn" data-row="2" data-col="4">Avoidable</button></div>

    <!-- Row 4 -->
    <div class="grid-cell"></div>
    <div class="grid-cell"></div>
    <div class="grid-cell"></div>
    <div class="grid-cell"><button class="row7-btn" data-row="3" data-col="3">Planet Market</button></div>
    <div class="grid-cell"></div>
</div>

<script>
function getButtonCenter(button) {
    const container = document.querySelector('.grid-container');
    const rect = button.getBoundingClientRect();
    const containerRect = container.getBoundingClientRect();
    return { x: rect.left + rect.width/2 - containerRect.left, y: rect.top + rect.height/2 - containerRect.top };
}

function drawConnections() {
    const svg = document.getElementById('connectionSvg');
    svg.innerHTML = '';
    const buttons = document.querySelectorAll('button');
    const buttonMap = {};
    buttons.forEach(btn => buttonMap[`${btn.dataset.row}-${btn.dataset.col}`] = getButtonCenter(btn));

    const connections = [
        {from:'1-0',to:'0-2'},{from:'1-1',to:'0-2'},{from:'1-2',to:'0-2'},{from:'1-3',to:'0-2'},{from:'1-4',to:'0-2'},
        {from:'1-0',to:'2-0'},{from:'1-1',to:'2-1'},{from:'1-2',to:'2-2'},{from:'1-3',to:'2-3'},{from:'1-4',to:'2-4'},
        {from:'2-2',to:'3-3'},{from:'2-3',to:'3-3'},{from:'2-4',to:'3-3'}
    ];

    connections.forEach(conn=>{
        if(buttonMap[conn.from] && buttonMap[conn.to]){
            const line = document.createElementNS('http://www.w3.org/2000/svg','line');
            line.classList.add('line');
            line.setAttribute('x1', buttonMap[conn.from].x);
            line.setAttribute('y1', buttonMap[conn.from].y);
            line.setAttribute('x2', buttonMap[conn.to].x);
            line.setAttribute('y2', buttonMap[conn.to].y);
            svg.appendChild(line);
        }
    });
}

window.addEventListener('load', drawConnections);
const resizeObserver = new ResizeObserver(drawConnections);
resizeObserver.observe(document.querySelector('.grid-container'));

// Only ripple animation on click
document.querySelectorAll('button').forEach(btn=>{
    btn.addEventListener('click', e=>{
        const circle = document.createElement('span');
        circle.classList.add('ripple');
        const rect = btn.getBoundingClientRect();
        const size = Math.max(rect.width, rect.height);
        circle.style.width = circle.style.height = size + 'px';
        circle.style.left = (e.clientX - rect.left - size/2)+'px';
        circle.style.top = (e.clientY - rect.top - size/2)+'px';
        btn.appendChild(circle);
        setTimeout(()=>circle.remove(),600);
    });
});
</script>
</body>
</html>
